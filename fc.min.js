// Fat Controller - a messaging/signalling service in JS
// https://github.com/markfinger/fatcontroller

// Minified version of fc.js

window.fc=function(){function g(a){c[a.name].forEach(function(b){void 0!==b.thisArg?b.callback.call(b.thisArg,JSON.parse(JSON.stringify(a))):b.callback(JSON.parse(JSON.stringify(a)))});return a}function d(a){if("string"!=typeof a)throw new TypeError("fc._checkMessage: `message` must be a string.");if(!/^[a-z0-9_/ /:/-]+$/i.test(a))throw Error("fc._checkMessage: `message` must be a string containing at least one character, and composed only of alphanumeric characters, underscores, spaces, colons, and dashes.");
if(3<a.split(":").length)throw Error("fc._checkMessage: `message` may contain at most three colons, example: `namespace:event:identifier`.");var b=a.split(":"),a=1==b.length?a:b[0]+":"+b[1];return a}function e(a){a=a.split(":");if(3==a.length)return a[2]}var c={};return{publish:function(a,b){var c=d(a),f=(new Date).getTime(),i=e(a);if(!(void 0===b||"object"==typeof b))throw new TypeError("fc._checkData: `data` must be either undefined or an object.");return g({name:c,timestamp:f,identifier:i,data:b})},
subscribe:function(a,b,h){var f=d(a);if("function"!=typeof b)throw new TypeError("fc._checkCallback: `callback` must be a function.");a={messageName:f,callback:b,identifier:e(a),thisArg:h};(b=c[a.messageName])||(b=c[a.messageName]=[]);b.push(a);return a},unsubscribe:function(a){var b=e(a),a=d(a);b&&(c[a]=c[a].filter(function(a){return a.identifier!=this},b));(!b||!c[a].length)&&delete c[a];return a},registry:function(){return c}}}();